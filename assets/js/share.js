const PERFORMANCE_CONFIG={DEBOUNCE_DELAY:150,VISIBILITY_CHECK_DELAY:100,TOAST_DURATION:2e3};function debounce(e,t){let n;return function(...s){const o=()=>{clearTimeout(n),e(...s)};clearTimeout(n),n=setTimeout(o,t)}}function throttle(e,t){let n;return function(){const s=arguments,o=this;n||(e.apply(o,s),n=!0,setTimeout(()=>n=!1,t))}}async function copyPageLink(){const e=window.location.href;try{navigator.clipboard&&window.isSecureContext?(await navigator.clipboard.writeText(e),showToast("Link copiado!")):fallbackCopyTextToClipboard(e)}catch(t){console.warn("Erro ao copiar:",t),fallbackCopyTextToClipboard(e)}}function fallbackCopyTextToClipboard(e){const t=document.createElement("textarea");t.value=e,t.style.cssText="position:fixed;left:-999999px;top:-999999px;opacity:0;",document.body.appendChild(t);try{t.select();const e=document.execCommand("copy");e?showToast("Link copiado!"):showToast("Erro ao copiar link",!1)}catch{showToast("Erro ao copiar link",!1)}finally{document.body.removeChild(t)}}let toastTimeout;function showToast(e,t=!0){const n=document.getElementById("shareToast");if(!n)return;toastTimeout&&clearTimeout(toastTimeout),n.textContent=e,n.style.background=t?"var(--color-accent)":"#ef4444",requestAnimationFrame(()=>{n.classList.add("show")}),toastTimeout=setTimeout(()=>{n.classList.remove("show")},PERFORMANCE_CONFIG.TOAST_DURATION)}const ensureButtonVisibility=throttle(()=>{const e=document.querySelector(".floating-share");if(!e)return;if(window.innerWidth<=768){const t={position:"fixed",display:"flex",visibility:"visible",opacity:"1",zIndex:"99999",background:"#10b981",border:"2px solid rgba(255,255,255,0.8)"};Object.assign(e.style,t)}},PERFORMANCE_CONFIG.DEBOUNCE_DELAY);function initNativeSharing(){if(!navigator.share)return;const e=document.querySelector(".floating-share");if(!e)return;e.removeEventListener("click",handleNativeShare),e.addEventListener("click",handleNativeShare)}async function handleNativeShare(e){e.preventDefault();try{await navigator.share({title:document.title,url:window.location.href})}catch{copyPageLink()}}function initLazyLoading(){if(!("IntersectionObserver"in window))return;const e=new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){const n=t.target;n.dataset.src&&(n.src=n.dataset.src,n.removeAttribute("data-src"),e.unobserve(n))}})},{rootMargin:"50px 0px",threshold:.01});document.querySelectorAll("img[data-src]").forEach(t=>{e.observe(t)})}function init(){initNativeSharing(),ensureButtonVisibility(),initLazyLoading(),setTimeout(ensureButtonVisibility,PERFORMANCE_CONFIG.VISIBILITY_CHECK_DELAY)}document.addEventListener("DOMContentLoaded",init),window.addEventListener("orientationchange",debounce(()=>{setTimeout(ensureButtonVisibility,PERFORMANCE_CONFIG.VISIBILITY_CHECK_DELAY)},PERFORMANCE_CONFIG.DEBOUNCE_DELAY)),window.addEventListener("resize",debounce(ensureButtonVisibility,PERFORMANCE_CONFIG.DEBOUNCE_DELAY)),document.addEventListener("visibilitychange",()=>{document.hidden||ensureButtonVisibility()});function scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}function toggleBackToTopButton(){const e=document.querySelector(".back-to-top");if(!e)return;window.scrollY>300?e.classList.add("show"):e.classList.remove("show")}window.addEventListener("scroll",throttle(toggleBackToTopButton,100)),document.addEventListener("DOMContentLoaded",()=>{toggleBackToTopButton()}),window.copyPageLink=copyPageLink
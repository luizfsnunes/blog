<!doctype html><html lang=pt-BR><meta charset=utf-8><title>Como o contexto transforma logs confusos em logs úteis – nilPointer</title><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=../assets/images/favicon.min.svg type=image/svg+xml><link rel=icon href=../assets/images/logo.png type=image/png sizes=32x32><title>Como O Contexto Transforma Logs Confusos Em Logs Úteis - nilPointer</title><meta name=description content="Logs contextualizados são uma ferramenta poderosa"><meta name=author content="Adão"><meta name=keywords content="logging estruturado,request id,observabilidade,boas práticas,depuração,backend"><link rel=canonical href=https://blog.nilpointer.com.br/posts/oriente_logs_ao_fluxo.html><link rel=alternate type=application/rss+xml title="RSS Feed" href=https://blog.nilpointer.com.br/rss.xml><meta property="og:type" content="article"><meta property="og:url" content="https://blog.nilpointer.com.br/posts/oriente_logs_ao_fluxo.html"><meta property="og:title" content="Como O Contexto Transforma Logs Confusos Em Logs Úteis"><meta property="og:description" content="Logs contextualizados são uma ferramenta poderosa"><meta property="og:site_name" content="nilPointer"><meta property="og:image" content="https://blog.nilpointer.com.br/assets/images/logo.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta property="og:image:alt" content="Como o contexto transforma logs confusos em logs úteis"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://blog.nilpointer.com.br/posts/oriente_logs_ao_fluxo.html"><meta property="twitter:title" content="Como O Contexto Transforma Logs Confusos Em Logs Úteis"><meta property="twitter:description" content="Logs contextualizados são uma ferramenta poderosa"><meta property="twitter:image" content="https://blog.nilpointer.com.br/assets/images/logo.png"><meta property="twitter:site" content="@luizfsnunes"><meta property="twitter:creator" content="@luizfsnunes"><meta property="og:locale" content="pt_BR"><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload href="../assets/css/style.css?v=1.2" as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href="../assets/css/style.css?v=1.2"></noscript><link rel=preload href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap"></noscript><link rel=preload as=image href=../assets/images/logo.svg type=image/svg+xml><script defer src=https://cloud.umami.is/script.js data-website-id=b71aba0c-8cf4-4785-b2f7-94e0bbccc8cd></script><script>(function(){setTimeout(function(){if(typeof umami=="undefined"){console.log("Umami blocked by ad blocker, trying alternative...");var e=document.createElement("script");e.src="https://cloud.umami.is/script.js",e.setAttribute("data-website-id","b71aba0c-8cf4-4785-b2f7-94e0bbccc8cd"),e.defer=!0,document.head.appendChild(e)}},1e3)})()</script><style>:root{--color-primary:#1a202c;--color-accent:#10b981;--color-background:#f5f5f0;--font-family:'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif}body{font-family:var(--font-family);background:linear-gradient(135deg,var(--color-background) 0%,#f1f5f9 100%);margin:0;padding:0}body.font-fallback{font-family:-apple-system,BlinkMacSystemFont,segoe ui,Roboto,helvetica neue,Arial,sans-serif}.container{max-width:800px;margin:0 auto;padding:0 2.5rem}.header{padding:2rem 0 1.5rem;text-align:center}.site-logo img{width:32px;height:32px;display:block}</style><script>(function(){document.addEventListener("DOMContentLoaded",function(){setTimeout(function(){(!document.fonts||!document.fonts.check("1em Inter"))&&(console.log("Inter font not loaded, using system fonts"),document.body.classList.add("font-fallback"))},3e3)})})()</script><link rel=stylesheet href=../assets/css/style.css><script defer src=../assets/js/share.js></script><header class="header header-centered"><div class=container><h1 class=site-logo><a href=../index.html aria-label="nilPointer - Página inicial"><img src=../assets/images/logo.svg alt=nilPointer width=240 height=180></a></h1><nav class=main-nav><ul><li><a href=../index.html>Início</a><li><a href=../arquivo.html>Arquivo</a><li><a href=https://blog.nilpointer.com.br/rss.xml title="RSS Feed" aria-label="RSS Feed"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M2.13 11.733c-1.175.0-2.13.958-2.13 2.132s.955 2.132 2.13 2.132 2.13-.958 2.13-2.132-.955-2.132-2.13-2.132zM.002 9.647c3.988.0 7.222 3.235 7.222 7.223H9.78c0-4.501-3.65-8.151-8.151-8.151V7.647zm.003-2.644c7.297.0 13.22 5.925 13.22 13.222h1.078c0-7.88-6.398-14.278-14.278-14.278V7.003z"/></svg></a></ul></nav></div></header><main class=container><article class=post><header class=post-header><div class=post-meta><time class=post-date datetime=2025-07-02>6 de July, 2025</time><div class=post-meta-tags><a href="../arquivo.html?categoria=observabilidade" class=post-category>Observabilidade</a><div class=post-tags><a href="../arquivo.html?tags=logs" class=post-tag>logs</a>
<a href="../arquivo.html?tags=boas%20pr%c3%a1ticas" class=post-tag>boas práticas</a></div></div></div><h1 class=post-title>Como o contexto transforma logs confusos em logs úteis</h1><p class=post-subtitle>Logs contextualizados são uma ferramenta poderosa</header><div class=post-content><p>Os <em>logs</em> da aplicação são essenciais para manter a visibilidade do que está ocorrendo internamente.
Erros, mensagens informativas e de alerta podem ser facilmente lidas nas máquinas em que a aplicação é executada.
Diagnosticar problemas ou simplesmente obter informações se torna simples.
Mas às vezes podem não ajudar:<ul><li>Não há uma forma de rastrear <em>logs</em> da mesma requisição<li>Muito ruído gerado por <em>logs</em> duplicados<li>Difícil de encontrar entradas específicas<li>Não existem mensagens relevantes</ul><p>Podemos usar algumas técnicas para ajudar na qualidade dos <em>logs</em>, os tornando mais fáceis de entender.<h2 id=o-contexto-conta>O contexto conta <a class=anchor href=#o-contexto-conta>¶</a></h2><p>Como em muitas outras coisas, o contexto é importante para os <em>logs</em>.
Assim podemos entender mais facilmente as mensagens, ainda mais em sistemas concorrentes, como em <em>APIs</em>.
Nestes casos, se não tivermos uma forma de saber de qual <em>request</em> o <em>log</em> pertence, temos a seguinte situação:<pre><code>2025-07-02T14:37:45.123Z [INFO]  Processing /users
2025-07-02T14:37:45.456Z [INFO]  Processing /users
2025-07-02T14:37:45.789Z [INFO]  Processing /orders
2025-07-02T14:37:46.250Z [INFO]  Finished /users (200 OK, 125 ms)
2025-07-02T14:37:46.300Z [ERROR] /users failed: Internal error
2025-07-02T14:37:46.550Z [ERROR] /orders failed: timeout
</code></pre><p>Temos um erro no <em>log</em>, mas não sabemos a qual entrada anterior ele se refere.
Não há como saber apenas olhando os <em>logs</em>, apesar de existir o <em>timestamp</em>.
Como é a natureza de <em>APIs</em> receber diferentes requisições, se não há como relacionar um <em>log</em> ao outro e as mensagens se tornam inúteis.
Neste caso podemos contextualizar, relacionando mensagens diferentes em grupos:<pre><code>2025-07-02T14:37:45.123Z [INFO]  [request_id:1000] Processing /users
2025-07-02T14:37:45.456Z [INFO]  [request_id:2001] Processing /users
2025-07-02T14:37:45.789Z [INFO]  [request_id:0100] Processing /orders
2025-07-02T14:37:46.250Z [INFO]  [request_id:1000] Finished /users (200 OK, 125 ms)
2025-07-02T14:37:46.300Z [ERROR] [request_id:2001] /users failed: Internal error
2025-07-02T14:37:46.550Z [ERROR] [request_id:0100] /orders failed: timeout
</code></pre><p>Agora sabemos que foi o <code>request_id:2001</code>.<p>É claro que os IDs são ilustrativos, podemos usar um simples <em>UUID</em> em cada um deles para gerar esse <em>trace</em>.
Agora sabemos quem pertence a um <em>request</em> em específico, nos dado um fluxo cronológico mais fácil de entender.<h2 id=trate-os-logs-como-fluxo-da-aplicao>Trate os <em>logs</em> como fluxo da aplicação <a class=anchor href=#trate-os-logs-como-fluxo-da-aplicao>¶</a></h2><p>Para um <em>debug</em> real, saber qual a ordem das entradas não é o suficiente. Considere:<pre><code>2025-07-02T14:37:45.123Z [INFO]  [request_id:200] Processing /users
2025-07-02T14:37:46.300Z [ERROR] [request_id:200] /users failed: Internal error
</code></pre><p>Sabemos qual chamada em <em>/users</em> foi completada com erro.
Mas não sabemos exatamente o que ocorreu, não há mais informações.
Requisições fazem várias tarefas como validar, salvar e executar lógica.
Não sabemos em qual tarefa o erro foi emitido, apenas que algo de errado ocorreu.
É difícil chegar a uma conclusão com esses dados.
Em um cenário real, produtivo, ter o máximo de informações é importante.
Assim podemos adicionar mais informações no <em>log</em> do que ocorreu no processo completo:<pre><code>2025-07-02T14:37:45.123Z [INFO]  [request_id:200] Processing /users
2025-07-02T14:37:45.200Z [INFO]  [request_id:200] Validated with success
2025-07-02T14:37:45.200Z [INFO]  [request_id:200] User is admin, allow changes
2025-07-02T14:37:46.300Z [ERROR] [request_id:200] Repository error: query=&quot;SELECT id, name FROM users WHERE id = $1&quot; args=[42] err=&quot;pq: relation \&quot;users\&quot; does not exist&quot;
2025-07-02T14:37:46.350Z [ERROR] [request_id:200] /users failed: Internal error
</code></pre><p>Assim fica mais fácil de entender que o Banco de Dados foi o problema.
Temos até a <em>query</em> problemática!
Mas ainda temos mais um problema, está verboso demais e sem informações cruciais.
Afinal, quem foi o <code>user</code> problemático?<h3 id=seja-minimalista>Seja minimalista <a class=anchor href=#seja-minimalista>¶</a></h3><p>O <em>log</em> acima está detalhado, mas há uma questão, a seguinte entrada não adiciona muito:<pre><code>2025-07-02T14:37:45.200Z [INFO]  [request_id:200] Validated with success
</code></pre><p>Em uma <em>API</em> com <em>RPS</em> médio esse tipo de mensagem acaba gerando muita <em>interferência</em> no que realmente é importante.
Logo podemos ignorar esse tipo de entrada.
Podemos manter a entrada:<pre><code>2025-07-02T14:37:45.200Z [INFO]  [request_id:200] User is admin, allow changes
</code></pre><p>Pois ela é significativa no processo e para o contexto essa informação pode ser importante.<blockquote><p>Adicione <em>logs</em> que sejam úteis para o entendimento do fluxo.</blockquote><h3 id=crie-logs-estruturados>Crie <em>logs</em> estruturados <a class=anchor href=#crie-logs-estruturados>¶</a></h3><p>Os <em>logs</em> que mostramos são difíceis de buscar, pois dependemos de texto interpolado.
Buscas em texto não são muito produtivas e também adicionam muita verbosidade.
Podemos estruturar em campos separados, adicionando mais detalhe:<pre><code>2025-07-02T14:37:45.123Z [INFO] [request_id:200] [user:maria] Processing /users
2025-07-02T14:37:45.200Z [INFO] [request_id:200] [user:maria] [role:admin] Change allowed for role
2025-07-02T14:37:46.300Z [ERROR] [request_id:200] [user:maria] Repository error: query=&quot;SELECT id, name FROM users WHERE id = $1&quot; args=[42] err=&quot;pq: relation \&quot;users\&quot; does not exist&quot;
2025-07-02T14:37:46.350Z [ERROR] [request_id:200] [user:maria] /users failed: Internal error
</code></pre><p>De acordo com o <em>log</em> sabemos que o usuário <code>maria</code> possui privilégios administrativos.
A regra permite alterações para este <em>role</em>.
Assim temos mais detalhes da operação, temos mais insumos para verificar no código.
Em ferramentas como o <em>Kibana</em> é mais fácil de filtrar e entender o que ocorreu em vez de depender de mensagens.<h2 id=concluindo>Concluindo <a class=anchor href=#concluindo>¶</a></h2><p><em>Logs</em> contextualizados transformam a experiência de <em>debug</em> de &ldquo;procurar agulha no palheiro&rdquo; para &ldquo;seguir um rastro claro&rdquo;.<p>Com <code>request_id</code>, <code>user_id</code> e demais campos estruturados, você não apenas vê o que aconteceu, mas entende o fluxo completo da aplicação.
É a diferença entre <em>logs</em> que confundem e <em>logs</em> que resolvem problemas.</div><footer class=post-footer><nav class=post-navigation aria-label="Navegação entre posts"><div class=nav-links><div class="btn btn--outline nav-prev nav-disabled" title="Não há post anterior"><span class=nav-arrow>←</span>
<span class=nav-title>Anterior</span></div><a href=https://blog.nilpointer.com.br/posts/como_o_contexto_transforma_logs_confusos_em_logs_uteis.html class="btn btn--outline nav-next" title="Próximo post" aria-label="Próximo post"><span class=nav-title>Próximo</span>
<span class=nav-arrow>→</span></a></div><div class=nav-info><a href=../ class="btn btn--solid nav-back" title="Voltar para o blog"><span>🏠</span> Voltar para o blog
</a><a href=https://blog.nilpointer.com.br/posts/oriente_logs_ao_fluxo.html class="btn btn--outline nav-first" title="Primeiro post"><span>📝</span> Primeiro post
</a><a href=https://blog.nilpointer.com.br/posts/testes_que_importam.html class="btn btn--outline nav-last" title="Último post"><span>📚</span> Último post</a></div></nav></footer></article></main><footer class=footer role=contentinfo><div class=container><div class=footer-content><div class=footer-slogan><h3>A arte de evitar nil</h3><p>Programação, desenvolvimento e boas práticas</div><div class=footer-info><p>&copy; 2025 nilPointer.<p class=footer-stats>4 artigos sobre A arte de evitar nil</div></div></div></footer><button class=floating-share onclick=copyPageLink() title=Compartilhar>
<span class=share-icon>🔗</span></button><div id=shareToast class=share-toast></div><button class=back-to-top onclick=scrollToTop() title="Voltar ao topo">
<span class=back-to-top-icon>↑</span></button>